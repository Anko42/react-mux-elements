{
  "version": 3,
  "sources": ["../src/use-combined-refs.ts", "../src/index.tsx", "../src/env.ts"],
  "sourcesContent": ["import { useEffect, useRef, MutableRefObject } from 'react';\n\ntype Maybe<T> = T | null | undefined;\ntype RefCb<T> = (instance: Maybe<T>) => void;\ntype RefObj<T> = MutableRefObject<Maybe<T>>;\ntype RefTypes<T> = RefObj<T> | RefCb<T>;\ninterface useCombinedRefs {\n  <T>(...refs: Maybe<RefTypes<T>>[]): RefObj<T>;\n}\n\nexport const useCombinedRefs: useCombinedRefs = (...refs) => {\n  const targetRef = useRef(null);\n\n  useEffect(() => {\n    refs.forEach((ref) => {\n      if (!ref) return;\n\n      if (typeof ref === 'function') {\n        ref(targetRef.current);\n      } else {\n        ref.current = targetRef.current;\n      }\n    });\n  }, [refs]);\n\n  return targetRef;\n};\n\n// TS assumed default export was interface def instead of function value (CJP)\nconst defaultUseCombinedRefs = useCombinedRefs;\nexport default defaultUseCombinedRefs;\n", "import { useCombinedRefs } from './use-combined-refs';\nimport React, { useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  allMediaTypes,\n  initialize,\n  MuxMediaProps,\n  StreamTypes,\n  PlaybackTypes,\n  toMuxVideoURL,\n  generatePlayerInitTime,\n} from '@mux/playback-core';\nimport type { PlaybackCore } from '@mux/playback-core';\nimport { getPlayerVersion } from './env';\n\nexport type Props = Omit<\n  React.DetailedHTMLProps<React.VideoHTMLAttributes<HTMLVideoElement>, HTMLVideoElement>,\n  'autoPlay'\n> &\n  MuxMediaProps;\n\nconst playerSoftwareVersion = getPlayerVersion();\nconst playerSoftwareName = 'mux-video-react';\n\nconst MuxVideo = React.forwardRef<HTMLVideoElement | undefined, Partial<Props>>((props, ref) => {\n  const {\n    envKey,\n    debug,\n    beaconCollectionDomain,\n    playbackId,\n    preferPlayback,\n    type,\n    streamType,\n    startTime,\n    src: outerSrc,\n    children,\n    autoPlay,\n    preload,\n    videoQuality = 2,\n    ...restProps\n  } = props;\n\n  const [playerInitTime] = useState(generatePlayerInitTime());\n  const [src, setSrc] = useState<MuxMediaProps['src']>(toMuxVideoURL(playbackId) ?? outerSrc);\n  const playbackCoreRef = useRef<PlaybackCore | undefined>(undefined);\n  const innerMediaElRef = useRef<HTMLVideoElement>(null);\n  const mediaElRef = useCombinedRefs(innerMediaElRef, ref);\n\n  useEffect(() => {\n    setSrc(toMuxVideoURL(playbackId) ?? outerSrc);\n  }, [outerSrc, playbackId]);\n\n  useEffect(() => {\n    if (\n      playbackCoreRef &&\n      playbackCoreRef.current &&\n      playbackCoreRef.current.engine &&\n      playbackCoreRef.current.engine.currentLevel\n    ) {\n      playbackCoreRef.current.engine.currentLevel = videoQuality;\n    }\n  }, [videoQuality]);\n\n  useEffect(() => {\n    const propsWithState = {\n      ...props,\n      src,\n      playerInitTime,\n      playerSoftwareName,\n      playerSoftwareVersion,\n      autoplay: autoPlay,\n    };\n    if (mediaElRef.current) {\n      playbackCoreRef.current = initialize(propsWithState, mediaElRef.current, playbackCoreRef.current);\n    }\n  }, [src]);\n\n  useEffect(() => {\n    playbackCoreRef.current?.setAutoplay(autoPlay);\n  }, [autoPlay]);\n\n  useEffect(() => {\n    playbackCoreRef.current?.setPreload(preload);\n  }, [preload]);\n\n  return (\n    /** @TODO Fix types relationships (CJP) */\n    <video ref={mediaElRef as typeof innerMediaElRef} {...restProps}>\n      {children}\n    </video>\n  );\n});\n\nMuxVideo.propTypes = {\n  envKey: PropTypes.string,\n  debug: PropTypes.bool,\n  disableCookies: PropTypes.bool,\n  // Improve this by adding a full shape() definition for all metadata props\n  // metadata: PropTypes.shape({}),\n  metadata: PropTypes.any,\n  beaconCollectionDomain: PropTypes.string,\n  playbackId: PropTypes.string,\n  playerInitTime: PropTypes.number,\n  preferPlayback: PropTypes.oneOf(Object.values(PlaybackTypes)),\n  type: PropTypes.oneOf(allMediaTypes),\n  streamType: PropTypes.oneOf(Object.values(StreamTypes)),\n  startTime: PropTypes.number,\n};\n\nexport default MuxVideo;\n", "export const isMaybeBrowser = () => typeof window != 'undefined';\n// @ts-ignore\nexport const isMaybeServer = () => typeof global != 'undefined';\n\nconst getEnvPlayerVersion = () => {\n  try {\n    // @ts-ignore\n    return PLAYER_VERSION as string;\n  } catch {}\n  return 'UNKNOWN';\n};\n\nconst player_version: string = getEnvPlayerVersion();\n\nexport const getPlayerVersion = () => player_version;\n"],
  "mappings": "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",
  "names": ["useEffect", "useRef", "useCombinedRefs", "refs", "targetRef", "ref", "React", "useEffect", "useRef", "useState", "PropTypes", "allMediaTypes", "initialize", "StreamTypes", "PlaybackTypes", "toMuxVideoURL", "generatePlayerInitTime", "getEnvPlayerVersion", "player_version", "getPlayerVersion", "playerSoftwareVersion", "getPlayerVersion", "playerSoftwareName", "MuxVideo", "React", "props", "ref", "_a", "envKey", "debug", "beaconCollectionDomain", "playbackId", "preferPlayback", "type", "streamType", "startTime", "outerSrc", "children", "autoPlay", "preload", "videoQuality", "restProps", "playerInitTime", "useState", "generatePlayerInitTime", "src", "setSrc", "toMuxVideoURL", "playbackCoreRef", "useRef", "innerMediaElRef", "mediaElRef", "useCombinedRefs", "useEffect", "propsWithState", "initialize", "PropTypes", "PlaybackTypes", "allMediaTypes", "StreamTypes", "src_default"]
}
